{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _createClass from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _classCallCheck from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\xampp1\\\\htdocs\\\\teacher11\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { FormWithConstraints } from './FormWithConstraints';\nimport { FieldFeedbacks } from './FieldFeedbacks';\nimport { withValidateFieldEventEmitter } from './withValidateFieldEventEmitter';\nexport var Status;\n\n(function (Status) {\n  Status[Status[\"None\"] = 0] = \"None\";\n  Status[Status[\"Pending\"] = 1] = \"Pending\";\n  Status[Status[\"Rejected\"] = 2] = \"Rejected\";\n  Status[Status[\"Resolved\"] = 3] = \"Resolved\";\n})(Status || (Status = {}));\n\nvar AsyncComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AsyncComponent, _React$Component);\n\n  function AsyncComponent() {\n    _classCallCheck(this, AsyncComponent);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(AsyncComponent).apply(this, arguments));\n  }\n\n  return AsyncComponent;\n}(React.Component);\n\nexport var Async =\n/*#__PURE__*/\nfunction (_withValidateFieldEve) {\n  _inherits(Async, _withValidateFieldEve);\n\n  function Async() {\n    var _this;\n\n    _classCallCheck(this, Async);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Async).apply(this, arguments));\n    _this.state = {\n      status: Status.None\n    };\n\n    _this.validate = function (input) {\n      var _this$context = _this.context,\n          form = _this$context.form,\n          fieldFeedbacks = _this$context.fieldFeedbacks;\n      var validations;\n      var field = form.fieldsStore.getField(input.name);\n\n      if (fieldFeedbacks.props.stop === 'first' && field.hasFeedbacks(fieldFeedbacks.key) || fieldFeedbacks.props.stop === 'first-error' && field.hasErrors(fieldFeedbacks.key) || fieldFeedbacks.props.stop === 'first-warning' && field.hasWarnings(fieldFeedbacks.key) || fieldFeedbacks.props.stop === 'first-info' && field.hasInfos(fieldFeedbacks.key)) {\n        _this.setState({\n          status: Status.None\n        });\n      } else {\n        validations = _this._validate(input);\n      }\n\n      return validations;\n    };\n\n    return _this;\n  }\n\n  _createClass(Async, [{\n    key: \"getChildContext\",\n    value: function getChildContext() {\n      return {\n        async: this\n      };\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.context.fieldFeedbacks.addValidateFieldEventListener(this.validate);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.context.fieldFeedbacks.removeValidateFieldEventListener(this.validate);\n    }\n  }, {\n    key: \"_validate\",\n    value: function () {\n      var _validate2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(input) {\n        var value;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  status: Status.Pending\n                });\n                _context.prev = 1;\n                _context.next = 4;\n                return this.props.promise(input.value);\n\n              case 4:\n                value = _context.sent;\n                this.setState({\n                  status: Status.Resolved,\n                  value: value\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](1);\n                this.setState({\n                  status: Status.Rejected,\n                  value: _context.t0\n                });\n\n              case 11:\n                return _context.abrupt(\"return\", this.emitValidateFieldEvent(input));\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 8]]);\n      }));\n\n      function _validate(_x) {\n        return _validate2.apply(this, arguments);\n      }\n\n      return _validate;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props,\n          state = this.state;\n      var element = null;\n\n      switch (state.status) {\n        case Status.None:\n          break;\n\n        case Status.Pending:\n          if (props.pending) element = props.pending;\n          break;\n\n        case Status.Resolved:\n          if (props.then) element = props.then(state.value);\n          break;\n\n        case Status.Rejected:\n          if (props.catch) element = props.catch(state.value);\n          break;\n      }\n\n      return element;\n    }\n  }]);\n\n  return Async;\n}(withValidateFieldEventEmitter(AsyncComponent));\nAsync.contextTypes = {\n  form: PropTypes.instanceOf(FormWithConstraints).isRequired,\n  fieldFeedbacks: PropTypes.instanceOf(FieldFeedbacks).isRequired\n};\nAsync.childContextTypes = {\n  async: PropTypes.instanceOf(Async).isRequired\n};","map":null,"metadata":{},"sourceType":"module"}